server {
  listen 80;

  location /videos/ {
    alias /storage/processed/;

    types {
      application/vnd.apple.mpegurl m3u8;
      video/mp2t ts;
    }

    add_header Cache-Control "no-store, no-cache, must-revalidate, proxy-revalidate";
    add_header Pragma "no-cache";
    add_header Expires "0";

    add_header Access-Control-Allow-Origin "*";
    add_header Access-Control-Allow-Methods "GET, HEAD, OPTIONS";
    add_header Access-Control-Allow-Headers "Range";
    add_header Accept-Ranges "bytes";
  }

  location /thumbnails/ {
    alias /storage/thumbnails/;

    types {
      image/jpeg jpg;
      image/png png;
      image/webp webp;
    }

    add_header Cache-Control "public, max-age=31536000, immutable";
    add_header Access-Control-Allow-Origin "*";
  }
}
